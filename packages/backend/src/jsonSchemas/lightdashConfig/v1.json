{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$id": "https://schemas.lightdash.com/lightdashConfig/v1.json",
    "title": "Lightdash Config",
    "description": "Configuration for a Lightdash project",
    "type": "object",
    "required": ["version", "projects"],
    "properties": {
        "version": {
            "description": "Schema version for the config file",
            "const": "1.0"
        },
        "projects": {
            "description": "A list of dbt projects configurations. Lightdash will attempt to compile and visualise these dbt projects.",
            "type": "array",
            "minItems": 1,
            "items": {
                "type": "object",
                "discriminator": {
                    "propertyName": "type"
                },
                "oneOf": [
                    {
                        "type": "object",
                        "required": ["type", "name"],
                        "properties": {
                            "type": {
                                "const": "dbt"
                            },
                            "name": {
                                "description": "Name to identify the project",
                                "type": "string"
                            },
                            "project_dir": {
                                "description": "File path to your dbt project directory containing a dbt_project.yml file",
                                "type": "string"
                            },
                            "profiles_dir": {
                                "description": "File path to your dbt profiles directory containing a profiles.yml file",
                                "type": "string"
                            },
                            "rpc_server_port": {
                                "description": "Port for the internal dbt server running on localhost",
                                "type": "integer",
                                "minimum": 1,
                                "default": 8580
                            }
                        }
                    },
                    {
                        "type": "object",
                        "required": ["type", "name"],
                        "properties": {
                            "type": {
                                "const": "dbt_remote_server"
                            },
                            "name": {
                                "description": "Name to identify the project",
                                "type": "string"
                            },
                            "rpc_server_host": {
                                "description": "Hostname of the remote dbt server",
                                "type": "string",
                                "format": "hostname",
                                "default": "localhost"
                            },
                            "rpc_server_port": {
                                "description": "Port of the remote dbt server",
                                "type": "integer",
                                "minimum": 1,
                                "default": 8580
                            }
                        }
                    }
                ]
            }
        }
    }
}
